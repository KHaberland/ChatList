# Спецификация программы ChatList

## 1. Назначение программы

ChatList — это Python-приложение, которое позволяет отправлять один и тот же промт в несколько нейросетей и сравнивать их ответы. Пользователь вводит текст запроса, программа отправляет его в выбранные модели и показывает результаты в виде временной таблицы. Отмеченные пользователем строки сохраняются в постоянную БД.

## 2. Стек

- Python 3.11+
- SQLite 
- Любая библиотека для HTTP-запросов (requests / httpx)
- GUI PyQt 

## 3. Таблицы базы данных

Программа хранит следующие данные в базе данных SQLite:

| Таблица | Описание | Поля |
|---------|----------|------|
| prompts | Таблица запросов | дата, промт, теги |
| models | Таблица нейросетей | name, api-url, api-id, is_active |
| results | Таблица сохраненных результатов | — |
| settings | Хранение настроек программы | — |

> **Примечание:** В таблице models хранятся не API-ключи, а имя переменной, где ключ лежит. Сами API-ключи будут в файле `.env`

## 4. Рабочий процесс

### 4.1 Ввод промта

Пользователь:
- вводит новый промт, или
- выбирает один из сохранённых в таблице prompts.

### 4.2 Отправка запроса

Программа:
- Берёт список активных моделей (`models.where(is_active=1)`).
- Отправляет промт в каждую модель.
- Создаёт временную таблицу результатов (в памяти, не в SQLite).

### 4.3 Интерфейс результатов

На экране пользователь видит таблицу, где каждая строка содержит:
- название модели
- текст ответа
- чекбокс `selected`

### 4.4 Сохранение выбранных результатов

Когда пользователь нажимает **Сохранить**:
- Все строки с `selected = True` записываются в таблицу results.
- Временная таблица очищается.

### 4.5 Новый запрос

При вводе нового промта временная таблица:
- удаляется полностью,
- создаётся заново после получения новых ответов.

## 5. Требования к реализации

| Модуль | Назначение |
|--------|------------|
| `db.py` | Доступ к SQLite (инкапсулирован) |
| `models.py` | Логика работы с моделями |
| `network.py` | Отправка запросов к API |
| `main.py` | Основной интерфейс |

## 6. Дополнительные функции (опционально)

- [ ] Поиск и сортировка во всех таблицах
- [ ] Экспорт выбранных результатов в Markdown / JSON
- [ ] Поддержка разных типов моделей (OpenAI, DeepSeek, Groq и т.д.)
- [ ] Логи запросов

## 7. Функция "AI-ассистент для улучшения промтов"

### Функционал:

1. Принимает исходный текст промта от пользователя
2. Отправляет его в одну указанную модель (через существующий OpenRouter-клиент)
3. Возвращает:
   - улучшенную версию промта
   - 2–3 варианта переформулировки
   - при необходимости — адаптацию промта под разные типы моделей (код, анализ, креатив)

### Интеграция в UI:

- Отдельная кнопка **«Улучшить промт»** рядом с полем ввода
- Окно/панель, где пользователь видит:
  - исходный промт
  - улучшенный
  - альтернативные варианты
- Возможность **«Подставить в поле ввода»** выбранный вариант одним кликом

## 8. Функция "Настройки"

1. Позволяет выбрать светлую/темную тему
2. Позволяет выбрать размер шрифта панелей
3. Все настройки сохраняются в таблицу `settings` в базе данных `chatlist.db`

## 9. Функция "О программе"

Выводит краткую информацию о программе.