# План реализации ChatList

## Этап 1: Подготовка проекта

1. **Настройка структуры проекта**
   - Создать файлы: `db.py`, `models.py`, `network.py`
   - Обновить `requirements.txt` с необходимыми зависимостями
   - Создать файл `.env.example` для шаблона API-ключей

2. **Установка зависимостей**
   ```powershell
   pip install PyQt6 httpx python-dotenv
   ```

---

## Этап 2: База данных (db.py)

1. **Создание модуля работы с SQLite**
   - Функция инициализации БД и создания таблиц
   - CRUD-операции для таблицы `prompts`
   - CRUD-операции для таблицы `models`
   - CRUD-операции для таблицы `results`
   - Функции для таблицы `settings`

2. **Миграции**
   - Автоматическое создание таблиц при первом запуске
   - Добавление тестовых данных (seed)

---

## Этап 3: Модели данных (models.py)

1. **Создание dataclass-ов**
   - `Prompt` — хранение промпта
   - `Model` — информация о LLM-модели
   - `Result` — результат тестирования
   - `Settings` — настройки приложения

---

## Этап 4: Сетевой модуль (network.py)

1. **Базовый HTTP-клиент**
   - Асинхронные запросы через `httpx`
   - Загрузка API-ключей из `.env`

2. **Адаптеры для разных API**
   - OpenAI-совместимый формат
   - Обработка ошибок и таймаутов
   - Потоковая передача ответов (опционально)

---

## Этап 5: Графический интерфейс (main.py)

### 5.1 Основное окно
- Создание главного окна PyQt
- Разметка интерфейса (layouts)

### 5.2 Панель ввода промпта
- Текстовое поле для ввода нового промпта
- Выпадающий список для выбора из истории (`prompts`)
- Кнопка "Отправить"

### 5.3 Панель управления моделями
- Список активных моделей с чекбоксами
- Кнопка настройки моделей

### 5.4 Область результатов
- Горизонтальный скролл для карточек ответов
- Карточка для каждой модели:
  - Название модели
  - Текст ответа
  - Чекбокс `selected` для сохранения

### 5.5 Панель действий
- Кнопка "Сохранить выбранные"
- Поиск по истории (по тексту и дате)

---

## Этап 6: Интеграция компонентов

1. **Связывание UI с логикой**
   - Подключение обработчиков событий
   - Валидация данных
   - Обработка ошибок с уведомлениями

2. **Асинхронное выполнение запросов**
   - Параллельная отправка промптов во все активные модели
   - Отображение прогресса загрузки
   - Обновление UI по мере получения ответов

---

## Этап 7: Дополнительные функции

1. **Тёмная тема**
   - Настройка стилей Qt
   - Переключатель в настройках

2. **Экспорт результатов**
   - Экспорт в Markdown
   - Экспорт в JSON

3. **Настройки приложения**
   - Диалог настроек
   - Управление списком моделей
   - Редактирование API endpoints

---

## Этап 8: Тестирование и сборка

1. **Тестирование**
   - Проверка всех CRUD-операций
   - Тестирование сетевых запросов
   - Проверка UI на разных разрешениях

2. **Сборка исполняемого файла**
   ```powershell
   pyinstaller --onefile --windowed main.py
   ```

3. **Финальная проверка**
   - Запуск на чистой системе
   - Проверка работы без Python

---

## Контрольные точки

| Этап | Описание | Статус |
|------|----------|--------|
| 1 | Структура проекта | ✅ |
| 2 | База данных | ✅ |
| 3 | Модели данных | ✅ |
| 4 | Сетевой модуль | ✅ |
| 5 | Графический интерфейс | ✅ |
| 6 | Интеграция | ✅ |
| 7 | Дополнительные функции | ⬜ |
| 8 | Тестирование и сборка | ⬜ |

